<div dir='rtl'>

# توثيق مكتبة الجافاسكريبت `دي3`

`دي3` هي مكتبة للغة الجافاسكريبت تهدف إلى التحكم في المستندات بناءً على المعلومات. `دي3` تساعدك في إضافة الحياة للمعلومات من خلال إستعمال ال`HTML`، ال`SVG`، و ال`CSS`.


تستند مكتبة `دي3` على معايير الويب لتتيح لك القدرة الكاملة لمتصفحات الويب الحديثة من دون الاعتماد على إطار تطوير كامل، وذلك من خلال تجميع مكونات متخصصة في عرض المعلومات مع شحن نظام قائم على المعلومات في التحكم في ال`DOM`.

> المكتبة في اصدارها (7.0.0) عند كتابة هذا التوثيق


## المقدمة:

`دي3` تمكنك من ربط معلومات مع نموذج كائن المستند `DOM`، و من بعد تطبيق تحويلات على المستند. على سبيل المثال، يمكنك إستعمال المكتبة لإنشاء جدول `HTML` إبتداءً من جدول من الأرقام. أو، إستعمال نفس المعلومات لانشاء رسم بياني تفاعلي مع انتقالات وتفاعل سلس.

`دي3` ليس إطارًا مترابطًا يسعى إلى توفير كل ميزة يمكن تصورها.
بدلاً من ذلك ، تحل `دي3` جوهر المشكلة: التلاعب الفعال بالمستندات على أساس البيانات.
هذا يتجنب التمثيل الاحتكاري ويوفر مرونة غير عادية ، ويكشف عن الإمكانات الكاملة لمعايير الويب مثل `HTML`، `SVG`، و `CSS`.
مع الحد الأدنى من الجهد، فإن `دي3` سريع للغاية ، ويدعم مجموعات البيانات الكبيرة والسلوكيات الديناميكية للتفاعل والرسوم المتحركة.

## التحديدات:

يعد تعديل المستندات باستخدام `W3C DOM API` أمرًا شاقًا:

إن أسماء الطرق مطولة ، ويتطلب نهج الأمر التكرار اليدوي ومسك دفاتر الحالة المؤقتة. 

على سبيل المثال ، لتغيير لون نص يجب كتبت كل هذا النص البرمجي: 

<div dir='ltr'>

```js
let paragraphs = document.getElementsByTagName(`p`);

for (let i = 0; i < paragraphs.length; ++i) {
    let paragraph = paragraphs.item(i);
    paragraph.style.setProperty(`color`, `blue`, null);
}
```

</div>

تستخدم `دي3` نهجًا تعريفيًا ، يعمل على مجموعات عشوائية من العقد تسمى التحديدات. 
على سبيل المثال ، يمكنك إعادة كتابة الحلقة أعلاه على النحو التالي: 

<div dir='ltr'>

```js
d3.selectAll(`p`).style(`color`, `lightgreen`);
```

</div>

ومع ذلك ، لا يزال بإمكانك معالجة العقد الفردية حسب الحاجة: 

<div dir='ltr'>

```js
d3.select(`body`).style(`background-color`, `#252525`);
```

</div>

يتم تحديد المحددات بواسطة واجهة برمجة تطبيقات `W3C Selectors` ويتم دعمها محليًا بواسطة المتصفحات الحديثة. 

تحدد الأمثلة أعلاه العقد حسب اسم العلامة ("p" و "body" ، على التوالي). 

يمكن تحديد العناصر باستخدام مجموعة متنوعة من المسندات ، بما في ذلك الاحتواء وقيم السمات والفئة والمعرف.

توفر D3 طرقًا عديدة لتعديل العقد: تعيين السمات أو الأنماط ؛ تسجيل مستمعي الحدث ؛ إضافة العقد أو إزالتها أو فرزها ؛ وتغيير محتوى HTML أو النص. 

هذه كافية لاغلبية  الاحتياجات. الوصول المباشر إلى `DOM` الأساسي ممكن أيضًا ، لأن كل تحديد `دي3` هو ببساطة مجموعة من العقد.

## الخصائص الديناميكية:

يجب على القراء المطلعين على أطر عمل `DOM` الأخرى مثل `jQuery` أن يتعرفوا على الفور على أوجه التشابه مع `دي3`. 

ومع ذلك ، يمكن تحديد الأنماط والسمات والخصائص الأخرى كوظائف للبيانات في `دي3`، وليس مجرد ثوابت بسيطة. 

على الرغم من بساطتها الواضحة ، يمكن أن تكون هذه الوظائف قوية بشكل مدهش ؛ 

وظيفة `d3.geoPath`، على سبيل المثال ، تعرض الإحداثيات الجغرافية في بيانات مسار `SVG`.

توفر `دي3` العديد من الوظائف المضمنة القابلة لإعادة الاستخدام ومصانع الوظائف ، مثل العناصر الأولية الرسومية لمخططات المنطقة والخط والدائرة.

على سبيل المثال، لتلوين الفقرات عشوائيًا: 

<div dir='ltr'>

```js
d3.selectAll(`p`).style(`color`, function() {
    return `hsl(${Math.random() * 360}, 100%, 50%)`;
});
```

</div>

لتبديل الظلال الرمادية للعقد الفردية والزوجية:

<div dir='ltr'>

```js
d3.selectAll(`p`).style(`color`, function(d, i) {
    return i % 2 ? `#fff` : `#eee`;
});
```

</div>

غالبًا ما تشير الخصائص المحسوبة إلى البيانات المرتبطة.

يتم تحديد البيانات كمصفوفة من القيم ، ويتم تمرير كل قيمة باعتبارها الوسيطة الأولى (`d`) إلى وظائف التحديد.

باستخدام الانضمام إلى الفهرس الافتراضي ، يتم تمرير العنصر الأول في مصفوفة البيانات إلى العقدة الأولى في التحديد ، والعنصر الثاني إلى العقدة الثانية ، وهكذا.

على سبيل المثال ، إذا قمت بربط مصفوفة من الأرقام بعناصر فقرة ، فيمكنك استخدام هذه الأرقام لحساب أحجام الخطوط الديناميكية: 


<div dir='ltr'>

```js
d3.selectAll(`p`)
    .data([4, 8, 15, 16, 23, 42])
        .style(`font-size`, function(d) {
            return `${d}px`;
        })
```

</div>

بمجرد ربط البيانات بالمستند، يمكنك حذف مشغل البيانات؛ 

سيقوم `دي3` باسترداد البيانات المقيدة مسبقًا. هذا يسمح لك بإعادة حساب الخصائص دون إعادة الربط. 

## الدخول والخروج:

باستخدام تحديدات الدخول والخروج في `دي3` ، يمكنك إنشاء عقد جديدة للبيانات الواردة وإزالة العقد الصادرة التي لم تعد مطلوبة.

عندما تكون البيانات مرتبطة بتحديد ، يتم إقران كل عنصر في مصفوفة البيانات بالعقدة المقابلة في التحديد. إذا كان هناك عدد أقل من العقد من البيانات ، فإن عناصر البيانات الإضافية تشكل تحديد الإدخال ، والذي يمكنك إنشاء مثيل له من خلال إلحاق تحديد الإدخال. فمثلا: 


<div dir='ltr'>

```js
d3.select(`body`)
    .selectAll(`p`)
        .data([4, 8, 15, 16, 23, 42])
            .enter().append(`p`)
                .text(function(d) {
                    return `I'm number ${d}!`;
                })
```

</div>

تحديث العقد هو الاختيار الافتراضي - نتيجة مشغل البيانات.

وبالتالي ، إذا نسيت تحديدات الدخول والخروج ، فستختار تلقائيًا فقط العناصر التي توجد لها بيانات مقابلة. 

يتمثل النمط الشائع في تقسيم التحديد الأولي إلى ثلاثة أجزاء: عقد التحديث المراد تعديله ، وعقد الإدخال المراد إضافتها ، وعقد الخروج المراد إزالتها.

<div dir='ltr'>

```js

// Update:
let p = d3.select(`body`)
    .selectAll(`p`)
        .data([4, 8, 15, 16, 23, 42])
            .text(function(d) {return d;})

// Enter:
p.enter().append(`p`)
    .text(function(d) {return d;});

// Exit:
p.exit().remove();

```

</div>

من خلال معالجة هذه الحالات الثلاث بشكل منفصل، فإنك تحدد بدقة العمليات التي تعمل على أي عقد. 

هذا يحسن الأداء ويوفر تحكمًا أكبر في الانتقالات.

على سبيل المثال ، باستخدام مخطط شريطي ، يمكنك تهيئة إدخال الأشرطة باستخدام المقياس القديم، ثم نقل أشرطة الدخول إلى المقياس الجديد جنبًا إلى جنب مع أشرطة التحديث والخروج.

يتيح لك `دي3` تحويل المستندات بناءً على البيانات؛ وهذا يشمل كلاً من إنشاء العناصر وتدميرها. 

يسمح لك `دي3` بتغيير مستند موجود استجابة لتفاعل المستخدم أو الرسوم المتحركة بمرور الوقت أو حتى إشعار غير متزامن من جهة خارجية.

من الممكن أيضًا اتباع نهج مختلط، حيث يتم تقديم المستند في البداية على الخادم وتحديثه على العميل عبر `دي3`.

## التحول وليس التمثيل:

لا تقدم مكتبة `دي3` تمثيلًا مرئيًا جديدًا.

تأتي مفردات `دي3` للعلامات الرسومية مباشرة من معايير الويب: `HTML` و `SVG` و `CSS`.

على سبيل المثال ، يمكنك إنشاء عناصر `SVG` باستخدام `دي3` وتصميمها باستخدام أوراق أنماط خارجية.

يمكنك استخدام تأثيرات المرشح المركب والحدود المتقطعة والقص.

إذا قدم موردو المتصفح ميزات جديدة غدًا، فستتمكن من استخدامها على الفور - ولا يلزم تحديث مجموعة الأدوات.

وإذا قررت في المستقبل استخدام مجموعة أدوات أخرى غير `دي3`، فيمكنك أن تأخذ معرفتك بالمعايير معك!

أفضل ما في الأمر هو أن `دي3` يسهل تصحيحه باستخدام فاحص العناصر المدمج بالمتصفح: العقد التي تتعامل معها باستخدام `دي3` هي بالضبط تلك التي يفهمها المتصفح أصلاً.

## الانتقالات:

يمتد تركيز `دي3` على التحول بشكل طبيعي إلى الانتقالات المتحركة.

الانتقالات تدريجيًا تقحم الأنماط والسمات بمرور الوقت.

الانتقالات تدريجيًا تقحم الأنماط والسمات يمكن التحكم في الحركة البينية من خلال وظائف التسهيل مثل الوقت `elastic` و `cubic-in-out` و `linear`.

تدعم أدوات الإقحام في `دي3` كلاً من العناصر الأولية ، مثل الأرقام والأرقام المضمنة في السلاسل (أحجام الخطوط وبيانات المسار وما إلى ذلك) والقيم المركبة.

يمكنك حتى توسيع سجل محرف `دي3` لدعم الخصائص المعقدة وهياكل البيانات.

على سبيل المثال، لتتلاشى خلفية الصفحة باللون الأسود: 


<div dir='ltr'>

```js
d3.select(`body`).transition()
    .style(`background-color`, `black`);
```

</div>

أو لتغيير حجم الدوائر في خريطة رمز بتأخير متقطع:

<div dir='ltr'>

```js
d3.selectAll(`circle`).transition()
    .duration(750)
    .delay(function(d, i) { return i * 10; })
    .attr(`r`, function(d) {
        return Math.sqrt(d * scale);
    });
```

</div>

من خلال تعديل السمات التي تتغير فعليًا فقط ، يقلل `دي3` من الحمل ويسمح بمزيد من التعقيد في الرسوم البيانية بمعدلات إطارات عالية.

يسمح `دي3` أيضًا بتسلسل التحولات المعقدة عبر الأحداث.

ولا يزال بإمكانك استخدام انتقالات `CSS3`؛ لا يحل `دي3` محل مربع أدوات المتصفح ، ولكنه يعرضه بطريقة أسهل في الاستخدام.

</div>